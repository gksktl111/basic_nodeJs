<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/style.css" />
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <title>Document</title>
  </head>
  <body class="grey-bg">
    <%- include('nav.ejs')%>
    <button class="post__add">새 게시물 작성</button>
    <div class="white-bg">
      <% posts.forEach(post => { %>
      <div class="list-box">
        <a href="/detail/<%= post._id %>">
          <h4><%= post.title %></h4>
        </a>
        <p><%= post.content %></p>
      </div>
      <% }); %>
    </div>

    <div class="pagination">
      <% for(let i = 1; i <= postCount; i++) {%> <% if(i == currentPage){%>
      <a href="/list/<%= i%>" class="currentpage"> <%= i%> </a>
      <%} else{%>
      <a href="/list/<%= i%>"><%= i%></a>

      <% } %> <% }%>
    </div>
  </body>

  <script>
    document.querySelector('.post__add').addEventListener('click', () => {
      axios
        .get('/write')
        .then((res) => {
          // 이쪽은 단순히 get 요청을 보내는것 파일을 랜더하는것은 서버에서
          window.location.href = '/write';
        })
        .catch((error) => {
          const userConfirmed = confirm(
            '로그인이 필요합니다. 로그인 하시겠습니까?'
          );
          if (userConfirmed) {
            // 사용자가 확인 버튼을 눌렀을 때의 동작
            // 예를 들어, 로그인 페이지로 이동하도록 할 수 있습니다.
            window.location.href = '/login';
          }
        });
    });
  </script>
</html>
